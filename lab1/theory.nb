(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16347,        526]
NotebookOptionsPosition[     15354,        488]
NotebookOutlinePosition[     15691,        503]
CellTagsIndexPosition[     15648,        500]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
      RowBox[{"d", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "d"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", "\[Rule]", 
      RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.664557001274247*^9, 3.664557059745555*^9}, {
  3.664557694746888*^9, 3.66455771113962*^9}, {3.665076459432364*^9, 
  3.665076470354368*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rr1", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", ",", "b", ",", "0"}], "}"}], "-", "r1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr2", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", ",", "b", ",", "0"}], "}"}], "-", "r2"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.664556819494055*^9, 3.664556849887437*^9}, {
  3.664556991054928*^9, 3.664556991845078*^9}, {3.664557715371626*^9, 
  3.66455774533454*^9}, {3.665076473544134*^9, 3.665076477598324*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F1", "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"G", " ", "M", " ", "m"}], 
     RowBox[{"rr1", ".", "rr1"}]], 
    RowBox[{"(", 
     FractionBox["rr1", 
      SqrtBox[
       RowBox[{"rr1", ".", "rr1"}]]], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.664556851348414*^9, 3.664556877312208*^9}, {
  3.66455699522785*^9, 3.664556999005731*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"G", " ", "m", " ", "M", " ", 
     RowBox[{"(", 
      RowBox[{"d", "-", 
       RowBox[{"d", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"d", "-", 
          RowBox[{"d", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], "2"], "+", 
       
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"b", "-", 
          RowBox[{"d", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}], 
      ")"}], 
     RowBox[{"3", "/", "2"}]]], ",", 
   FractionBox[
    RowBox[{"G", " ", "m", " ", "M", " ", 
     RowBox[{"(", 
      RowBox[{"b", "-", 
       RowBox[{"d", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"d", "-", 
          RowBox[{"d", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], "2"], "+", 
       
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"b", "-", 
          RowBox[{"d", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}], 
      ")"}], 
     RowBox[{"3", "/", "2"}]]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.664556873182995*^9, 3.664556878209787*^9}, {
   3.664557036297768*^9, 3.6645570619335127`*^9}, 3.664557749258045*^9, 
   3.6650764848415194`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F2", "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"G", " ", "M", " ", "m"}], 
     RowBox[{"rr2", ".", "rr2"}]], 
    RowBox[{"(", 
     FractionBox["rr2", 
      SqrtBox[
       RowBox[{"rr2", ".", "rr2"}]]], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.664556881265317*^9, 3.66455690984027*^9}, {
  3.664557039447194*^9, 3.6645570434448147`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", "G", " ", "m", " ", "M", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"d", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], "2"], "+", 
       
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"d", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}], 
      ")"}], 
     RowBox[{"3", "/", "2"}]]], ",", 
   FractionBox[
    RowBox[{"G", " ", "m", " ", "M", " ", 
     RowBox[{"(", 
      RowBox[{"b", "+", 
       RowBox[{"d", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"d", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], "2"], "+", 
       
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"d", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}], 
      ")"}], 
     RowBox[{"3", "/", "2"}]]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.664556910673607*^9, {3.664557044322014*^9, 3.664557062833459*^9}, 
   3.664557752276133*^9, 3.665076498433867*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Tau]Spheres", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Cross", "[", 
     RowBox[{"r2", ",", "F2"}], "]"}], "+", 
    RowBox[{"Cross", "[", 
     RowBox[{"r1", ",", "F1"}], "]"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.664556947840131*^9, 3.664556962350161*^9}, {
  3.664557327611045*^9, 3.664557358201887*^9}, {3.664557618704813*^9, 
  3.664557619738385*^9}, {3.664557675230145*^9, 3.664557675893485*^9}, {
  3.665076545240138*^9, 3.665076550662448*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"d", " ", "G", " ", "m", " ", "M", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "b"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["b", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}], "-", 
           RowBox[{"2", " ", "d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{"b", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
          ")"}], 
         RowBox[{"3", "/", "2"}]], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["b", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}], "+", 
           RowBox[{"2", " ", "d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{"b", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
          ")"}], 
         RowBox[{"3", "/", "2"}]]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["b", "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"]}], "-", 
         RowBox[{"2", " ", "d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"b", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
        ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["b", "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["d", "2"]}], "+", 
         RowBox[{"2", " ", "d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"b", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
        ")"}], 
       RowBox[{"3", "/", "2"}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.664556962745277*^9, {3.664557048204198*^9, 3.664557068194065*^9}, {
   3.664557337188747*^9, 3.664557360826489*^9}, 3.664557622540785*^9, 
   3.6645576767225723`*^9, 3.664557758160358*^9, 3.665076504110304*^9, 
   3.6650765516280622`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"l", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", 
     RowBox[{"l", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], ",", "0"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.664557581336102*^9, 3.664557592790666*^9}, {
  3.664557680729609*^9, 3.6645576848052883`*^9}, {3.664557760772949*^9, 
  3.664557787020054*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rp", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", ",", "b", ",", "0"}], "}"}], "-", "p"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6645577744398603`*^9, 3.6645577916441708`*^9}, {
  3.6645650686066*^9, 3.664565070877879*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"torqueRod", "[", "l_", "]"}], "=", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{"p", ",", 
        RowBox[{
         FractionBox[
          RowBox[{"G", " ", "M", " ", "\[Sigma]"}], 
          RowBox[{"rp", ".", "rp"}]], 
         RowBox[{"(", 
          FractionBox["rp", 
           SqrtBox[
            RowBox[{"rp", ".", "rp"}]]], ")"}]}]}], "]"}], ",", "l", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"b", ">", "0"}], ",", 
         RowBox[{"d", ">", "0"}], ",", 
         RowBox[{"G", ">", "0"}], ",", 
         RowBox[{"M", ">", "0"}], ",", 
         RowBox[{"\[Sigma]", ">", "0"}]}], "}"}]}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.664557795242262*^9, 3.6645578362942257`*^9}, {
  3.6650765186956053`*^9, 3.6650765775511417`*^9}, {3.665076869727048*^9, 
  3.6650769050979023`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Tau]Rod", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"torqueRod", "[", "d", "]"}], "-", 
    RowBox[{"torqueRod", "[", 
     RowBox[{"-", "d"}], "]"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6650766682383347`*^9, 3.665076679322769*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   FractionBox[
    RowBox[{"G", " ", "M", " ", "\[Sigma]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["d", "2"], "-", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"b", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox["b", "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}], "-", 
           RowBox[{"2", " ", "d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{"b", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}]]]}],
        "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["d", "2"], "+", 
         RowBox[{
          SuperscriptBox["d", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"b", " ", "d", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["b", "2"], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}], "+", 
          RowBox[{"2", " ", "d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"b", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ")"}]}]}]]]}], 
      ")"}]}], 
    RowBox[{
     RowBox[{"b", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}], "-", 
     RowBox[{"d", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.665076684312275*^9, {3.665076890425652*^9, 3.665076906831061*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"2", "\[Tau]Spheres"}], " ", "+", " ", 
     RowBox[{"2", "\[Tau]Rod"}], "-", 
     RowBox[{"\[Lambda]", 
      RowBox[{"(", 
       RowBox[{"\[Theta]", "-", "\[Theta]0"}], ")"}]}]}], "\[Equal]", "0"}], 
   ",", "G"}], "]"}]], "Input",
 CellChangeTimes->{{3.6650775029600077`*^9, 3.665077548645341*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.665077574625682*^9}]
}, Open  ]],

Cell[BoxData["."], "Input",
 CellChangeTimes->{3.665077574210877*^9}]
},
WindowSize->{958, 1028},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1005, 30, 55, "Input"],
Cell[1566, 52, 527, 15, 55, "Input"],
Cell[CellGroupData[{
Cell[2118, 71, 410, 13, 67, "Input"],
Cell[2531, 86, 1755, 55, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4323, 146, 412, 13, 67, "Input"],
Cell[4738, 161, 1706, 54, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6481, 220, 503, 11, 32, "Input"],
Cell[6987, 233, 3213, 91, 85, "Output"]
}, Open  ]],
Cell[10215, 327, 495, 14, 32, "Input"],
Cell[10713, 343, 270, 7, 32, "Input"],
Cell[10986, 352, 992, 28, 120, "Input"],
Cell[CellGroupData[{
Cell[12003, 384, 281, 7, 32, "Input"],
Cell[12287, 393, 2472, 70, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14796, 468, 390, 11, 32, "Input"],
Cell[15189, 481, 77, 1, 65, "Output"]
}, Open  ]],
Cell[15281, 485, 69, 1, 32, "Input"]
}
]
*)

(* End of internal cache information *)
